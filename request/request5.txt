select t1.user ,  count(t1.user),SEC_TO_TIME(AVG(TIME_TO_SEC(TIMEDIFF(t1.endtime,t1.starttime)))), SUM(case
                                                                                                       when TIME_TO_SEC(TIMEDIFF(t1.endtime,t1.starttime)) > 86400
                                                                                                       then 1+(6.5*(CEILING(TIME_TO_SEC(TIMEDIFF(t1.endtime,t1.starttime)))/3600))
                                                                                                       else 1+(36*(CEILING(TIME_TO_SEC(TIMEDIFF(t1.endtime,t1.starttime)))/86400))
                                                                                                       end
                                                                                                       ) As TotalAmount
from Trips t1
where count(t1.user)>=10
group by t1.user